<div>
  <div class="spinner-container" *ngIf="dataSource.loading$ | async">
    <mat-spinner></mat-spinner>
  </div>
  <div *ngIf="showError" id="errorCntr">
    <button id="errClsBtn" (click)="close()">
      X
    </button>
    <ul>
      <li *ngFor="let error of errors">
        {{ error }}
      </li>
    </ul>
  </div>
  <div
    fxLayout="row"
    fxLayoutAlign="end center"
    class="addNewDiv"
    fxLayoutGap="2px"
  >
    <div>
      <button
        mat-raised-button
        color="accent"
        class="btnAddPrd"
        (click)="gotoOffPeakProduct()"
      >
        Add Off-Peak Product
      </button>
    </div>
  </div>
  <div class="products__container">
    <div class="products__sub-container">
      <mat-table
        class="mat-elevation-z2 table"
        [dataSource]="dataSource"
        matSort
        matSortActive="name"
        matSortDirection="asc"
        matSortDisableClear
      >
        <ng-container matColumnDef="img">
          <mat-header-cell *matHeaderCellDef mat-sort-header
            >Image</mat-header-cell
          >
          <mat-cell *matCellDef="let product">
            <img class="img" [src]="product.imagePath" alt="" />
          </mat-cell>
        </ng-container>

        <ng-container matColumnDef="name">
          <mat-header-cell *matHeaderCellDef mat-sort-header
            >Name</mat-header-cell
          >

          <mat-cell *matCellDef="let product">{{ product.name }}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="shop">
          <mat-header-cell *matHeaderCellDef>Store</mat-header-cell>

          <mat-cell *matCellDef="let product">{{ product.shop.name }}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="discountPrice">
          <mat-header-cell *matHeaderCellDef>Regular Price</mat-header-cell>

          <mat-cell *matCellDef="let product">{{
            product.normalPrice | currency
          }}</mat-cell>
        </ng-container>
        <ng-container matColumnDef="dispercentage">
          <mat-header-cell *matHeaderCellDef>Disc %</mat-header-cell>

          <mat-cell *matCellDef="let product">{{
            product.discountPercentage
          }}</mat-cell>
        </ng-container>
        <ng-container matColumnDef="remove">
          <mat-header-cell *matHeaderCellDef></mat-header-cell>

          <mat-cell *matCellDef="let product"
            ><button mat-icon-button [matMenuTriggerFor]="menu">
              <mat-icon>more_vert</mat-icon>
            </button>
            <mat-menu #menu="matMenu">
              <button mat-menu-item (click)="removeProduct(product)">
                <mat-icon color="accent">delete</mat-icon>
                <span>Remove</span>
              </button>

              <button mat-menu-item (click)="editProduct(product)">
                <mat-icon color="accent">edit</mat-icon>
                <span>Edit</span>
              </button>
              <button mat-menu-item (click)="cloneProduct(product)">
                <mat-icon color="accent">add</mat-icon>
                <span>Copy</span>
              </button>
            </mat-menu>
          </mat-cell>
        </ng-container>
        <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>

        <mat-row *matRowDef="let row; columns: displayedColumns"></mat-row>
      </mat-table>
      <mat-paginator
        [length]="dataSource.count"
        [pageSize]="5"
        [pageSizeOptions]="[5, 10]"
      ></mat-paginator>
    </div>
  </div>
</div>
